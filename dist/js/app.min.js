"use strict";$(window).on("load",function(){function t(){if($('[data-mask="phone"]').length){n=new Cleave("[data-mask=phone]",{phone:!0,phoneRegionCode:"RU"});var t="+7",e=t.split("");$("[data-mask=phone]").trigger("focus"),n.setRawValue(t),$("[data-mask=phone]").on("keyup",function(t){var a=(n.getFormattedValue(),n.getRawValue());0!=a.indexOf(e[0])&&0==a.indexOf(e[1])?n.setRawValue(e[0]+a.substr(0)):1!=a.indexOf(e[1])&&0==a.indexOf(e[0])&&n.setRawValue(e[0]+e[1]+a.substr(1))})}}function e(t){var e,a=t.val(),s=t.attr("data-type")?t.attr("data-type"):t.attr("type"),o=(t.position().top,!0);return"confirmation-code"==s?(e=/^\d{4}$/,"Введите четырехзначный код"):"text"==s?(e=/^[A-Za-zА-Яа-яЁё][A-Za-zА-Яа-яЁё0-9\._-]{3,}$/,"От 4 до 20 символов"):"email"==s?(e=/^[a-z0-9_-]+([\.a-z]+)?@[a-z0-9-]+\.([a-z]{1,6}\.)?[a-z]{2,6}$/i,"Некорректный email"):"password"==s?(e=/^[\d\w\._-]{5,}$/i,"От 5 символов"):"tel"==s&&(a=n.getRawValue(),"Введите номер телефона без разделителей, скобок и дефисов",e=/^(\+7)\d{10,}$/),-1==a.search(e)&&(o=!1),o}function a(){var t=!0;return $("[data-required]").each(function(a,s){var n=$(s),o=n.closest(".form-group");t=e(n),t?o.hasClass("not-valid")&&o.removeClass("not-valid"):o.hasClass("not-valid")||o.addClass("not-valid")}),t}function s(t){var e=t,t=window.location.pathname;t=t.split("/"),t[t.length-1]=e,t=t.join("/"),a()&&(window.location.pathname=t)}var n;t(),$(".toggle-nav").on("click",function(t){$("body").hasClass("menu-visible")?$("body").removeClass("menu-visible"):$("body").addClass("menu-visible")}),$("[data-select=selectize]").selectize({create:!0,sortField:"text"}),function(){var t=$("[data-disabled-counter]"),e=t.find("[data-counter]"),a=+e.attr("data-counter-time");e.text(a);var s=setInterval(function(){if(a<=0)return clearInterval(s),t.removeAttr("disabled").html("Отправить код повторно"),!1;e.text(--a)},1e3)}(),$(".js-get-cert-progress").length&&setTimeout(function(){$(".js-get-cert-progress").removeClass("state-waiting").addClass("state-success"),setTimeout(function(){s("cert-info.html")},500)},4e3),$(".storage-item").on("click",function(){var t=$(this);t.hasClass("selected")||(t.closest(".storage-list").find(".storage-item.selected").removeClass("selected"),t.addClass("selected"))}),$(".cert-list .cert-item").on("click",function(){var t=$(this);t.hasClass("selected")||(t.closest(".cert-list").find(".cert-item.selected").removeClass("selected"),t.addClass("selected"))}),$(".help-info").tooltip(),$('[data-toggle="password-show"]').on("change",function(t){var e=$(this),a=$(e.attr("data-target")),s=a.attr("type"),n="password"==s?"text":"password";return a.attr("type",n),!1}),$('[data-required][data-maxlength][data-type="confirmation-code"]').on("keydown",function(t){var e=t.keyCode;if((e<48||e>57&&e<96||e>105)&&8!=e&&46!=e&&37!=e&&39!=e&&13!=e)return!1}),$("[data-required]").on("keyup",function(t){var a,s=$(this),n=s.closest(".form-group"),o=$("[type=submit][data-disabled-button]");s.val().length>+s.attr("data-maxlength")&&s.val(s.val().substr(0,+s.attr("data-maxlength"))),s.val().length>1?a=e(s):1==s.val().length&&(a=e(s)),a?(o&&o.removeAttr("disabled"),n.hasClass("not-valid")&&n.removeClass("not-valid")):(o&&o.attr("disabled","disabled"),n.hasClass("not-valid")&&n.addClass("not-valid"))}),$("[type=submit]").on("click",function(t){t.preventDefault(),s($(this).attr("data-success-location"))})});